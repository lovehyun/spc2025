<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>투두 리스트</h1>
    <input type="text" id="new-todo" placeholder="할일 적기...">
    <button id="add-todo">Add</button>
    <ul id="todo-list"></ul>

    <script>
        const todoList = document.getElementById('todo-list');
        const input = document.getElementById('new-todo');
        const addBtn = document.getElementById('add-todo');

        // 버튼 클릭시 추가 호출
        addBtn.addEventListener('click', async () => {
            // 입력값 읽어다가 백엔드 호출 (/api/todos) POST
            const text = input.value.trim();

            // fetch('/api/todos', {
            //     method: 'POST',
            //     headers: {'Content-Type': 'application/json'},
            //     body: JSON.stringify({text})
            // })
            const response = await axios.post('/api/todos', {text});
            const data = response.data;
            console.log(data);
            renderTodos();
        })

        // 화면에 투두리스트 가져와서 뿌리기 (렌더링)
        async function renderTodos() {
            // 백엔드에서 받아오기 (/api/todos) GET
            const response = await axios.get('/api/todos');
            const todos = response.data;
            todos.forEach(todo => {
                const li = document.createElement('li');
                li.textContent = todo.text;
                todoList.appendChild(li);
            })
        }

        renderTodos(); // 최초 호출
    </script>
</body>
</html>
